---
setup:
  - do:
      indices.create:
        index: test
        body:
          mappings:
            doc:
              properties:
                i:
                  type: integer
                  relocate_to: doc_values
                f:
                  type: double
                  relocate_to: doc_values
                ip:
                  type: ip
                  relocate_to: doc_values
                d:
                  type: date
                  relocate_to: doc_values

---
"basic":
  - skip:
      version: " - 6.99.99"
      reason: introduced in 7.0 (TODO change to 6.x when backported if backported)

  - do:
      index:
          index:  test
          type:   doc
          id:     1
          body:
              foo: bar
              i:   1
              f:   1.2
              ip:  192.168.0.1
              d:   "2018-01-01T12:33:55"

  - do:
      get:
          index:  test
          type:   doc
          id:     1
  - match: { _source.foo: bar }
  - match: { _source.i:   1 }
  - match: { _source.f:   1.2 }
  - match: { _source.ip:  192.168.0.1 }
  - match: { _source.d:   "2018-01-01T12:33:55.000Z" }

---
"multivalued":
  - skip:
      version: " - 6.99.99"
      reason: introduced in 7.0 (TODO change to 6.x when backported if backported)

  - do:
      index:
          index:  test
          type:   doc
          id:     1
          body:
              foo: bar
              i:   [1, 2]
              f:   [1.2, -7]
              ip:  [192.168.0.1, 192.168.0.2]
              d:   "2018-01-01T12:33:55"

  - do:
      get:
          index:  test
          type:   doc
          id:     1
  - match: { _source.foo: bar }
  - match: { _source.i:   [1, 2] }
  - match: { _source.f:   [1.2, -7] }
  - match: { _source.ip:  [192.168.0.1, 192.168.0.2] }
  - match: { _source.d:   "2018-01-01T12:33:55.000Z" }

---
"not all fields":
  - skip:
      version: " - 6.99.99"
      reason: introduced in 7.0 (TODO change to 6.x when backported if backported)

  - do:
      index:
          index:  test
          type:   doc
          id:     date
          body:
              d:   "2018-01-01T12:33:55"
  - do:
      get:
          index:  test
          type:   doc
          id:     date
  - match: { _source.d:   "2018-01-01T12:33:55.000Z" }

  - do:
      index:
          index:  test
          type:   doc
          id:     int
          body:
              i:   1
  - do:
      get:
          index:  test
          type:   doc
          id:     int
  - match: { _source.i:   1 }

  - do:
      index:
          index:  test
          type:   doc
          id:     double
          body:
              f:   1.2
  - do:
      get:
          index:  test
          type:   doc
          id:     double
  - match: { _source.f:   1.2 }

  - do:
      index:
          index:  test
          type:   doc
          id:     ip
          body:
              ip:  192.168.0.12
  - do:
      get:
          index:  test
          type:   doc
          id:     ip
  - match: { _source.ip:  192.168.0.12 }
